<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Mistyovo's Blog</title>
	<link rel="icon" href="/images/favicon.ico" type="image/x-icon">

	<link rel="stylesheet" href="https://mistyovo.xyz/libs/highlight/styles/atom-one-light.css">
	<script src="https://registry.npmmirror.com/twikoo/1.6.44/files/dist/twikoo.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js" integrity="sha512-EBLzUL8XLl+va/zAsmXwS7Z2B1F9HUHkZwyS/VKwh3S7T/U0nF4BaU29EP/ZSf6zgiIxYAnKLu6bJ8dqpmX5uw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/js/all.min.js" integrity="sha512-b+nQTCdtTBIRIbraqNEwsjB6UvL3UEMkXnhzd8awtCYh0Kcsjl9uEgwVFVbhoj3uu1DO1ZMacNvLoyJJiNfcvg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

	<script src="/js/cursor.js"></script>
	<script src="/js/fadeIn.js"></script>
	<script src="/js/snowfall.js"></script>
	
<link rel="stylesheet" href="/css/style.css">

	
<meta name="generator" content="Hexo 7.3.0"></head>

<body>
	<div id="container">
		<div id="wrap">
			<header>
    <div class="navbar">
        <div class="navbar-left">
            <a href="/" class="navbar-brand">Mistyovo&#39;s Blog</a>
        </div>
        <div class="navbar-right">
            <ul class="navbar-menu">
                
                    <li><a href="/"><i class="fa-solid fa-house"></i>首页</a></li>
                
                    <li><a href="/archives"><i class="fa-solid fa-box-archive"></i>归档</a></li>
                
                    <li><a href="/categories"><i class="fa-solid fa-list"></i>分类</a></li>
                
                    <li><a href="/tags"><i class="fa-solid fa-tags"></i>标签</a></li>
                
                    <li><a href="/todo"><i class="fa-solid fa-check"></i>待办</a></li>
                
                    <li><a href="/friends"><i class="fa-solid fa-link"></i>友链</a></li>
                
                    <li><a href="/resources"><i class="fa-solid fa-gift"></i>资源</a></li>
                
                    <li><a href="/AcgPic"><i class="fa-solid fa-image"></i>图床</a></li>
                
            </ul>
        </div>
    </div>
</header>
            <div class="sidebar">
	<!--头像-->
	<div class="author-info">
		<div class="avatar">
			<img id="avatar" src="/images/avatar_compressed.jpg" alt="博主头像">
		</div>
	</div>
	<script src="/js/avatar-rotate.js"></script>

	<!--博客信息-->
	<div style="font-size: 20px; font-weight: bold; color: #333; text-align: center; margin: 0 0 20px 0;">
		Mistyovo
	</div>
	<div style="font-size: 14px; color: #aaa; text-align: center; margin: 0 0 20px 0;">
		天下第一写屎山手请赐教
	</div>
	<div class="sidebar-stat">
		<ul class="sidebar-stats">
			<li>
				<p class="stat-value">
					16
				</p>
				<p class="stat-label">随笔</p>
			</li>
			<li>
				<p class="stat-value">
					3
				</p>
				<p class="stat-label">分类</p>
			</li>
			<li>
				<p class="stat-value">
					12
				</p>
				<p class="stat-label">标签</p>
			</li>
		</ul>
	</div>

	<!--社交链接-->
	<div class="sidebar-links">
		<ul class="sidebar-links-list">
			
				<li> 
					<a target="_blank" rel="noopener" href="https://space.bilibili.com/400701785">
						<i class="fa-brands fa-bilibili" style="color: #00aeec"></i> 
					</a> 
				</li>
			
				<li> 
					<a target="_blank" rel="noopener" href="https://github.com/Mistyovo">
						<i class="fa-brands fa-github-alt" style="color: #5b418b"></i> 
					</a> 
				</li>
			
				<li> 
					<a href="">
						<i class="fa-brands fa-discord" style="color: #5865f2"></i> 
					</a> 
				</li>
			
				<li> 
					<a href="">
						<i class="fa-brands fa-weixin" style="color: #38cd7f"></i> 
					</a> 
				</li>
			
				<li> 
					<a href="">
						<i class="fa-brands fa-qq" style="color: #0099ff"></i> 
					</a> 
				</li>
			
				<li> 
					<a target="_blank" rel="noopener" href="https://www.zhihu.com/people/mistyovo">
						<i class="fa-solid fa-envelope" style="color: pink"></i> 
					</a> 
				</li>
			
		</ul>
	</div>

	<!--公告板-->
	<div class="bulletin-board">
		<p class="bulletin">公告</p>
		<p class="bulletin-content">暂时还没有公告哦~</p>
	</div>
</div>
            <div class="outer">
                <section id="main">
			        <head>
    <link rel="stylesheet" href="/css/style.styl">
</head>
<div class="post">
    <div class="header-image"></div>
    <div style="text-align: center;">
        <h1>用C++读取鼠标在控制台上的操作</h1>
        <p style="color: #888"><i class="fa-regular fa-calendar-days"></i> Fri Jul 07 2023 18:18:51 GMT+0800</p>
        <br>
    </div>
    <div>
    <p>与读取键盘信息类似，读取鼠标信息也是通过 <code>ReadConsoleInput</code> 函数来实现</p>
<p>咱先说一下需要用到的头文件：</p>
<pre><code class="language-cpp">#include &lt;windows.h&gt;
</code></pre>
<p>响应鼠标点击事件的变量类型</p>
<pre><code class="language-cpp">INPUT_RECORD
</code></pre>
<p>咱先介绍一下<code>ReadConsoleInput</code>这个函数</p>
<pre><code class="language-cpp">typedef struct _MOUSE_EVENT_RECORD &#123; 
		COORD dwMousePosition;		// 当前鼠标位置
		DWORD dwButtonState;		// 鼠标按钮状态
		DWORD dwControlKeyState;	// 键盘控制键状态
		DWORD dwEventFlags; 		// 事件状态
&#125; MOUSE_EVENT_RECORD;
//这个东西一般都在&quot;INPUT_RECORD的变量名.Event.MouseEvent.以上变量&quot;
</code></pre>
<p>1.第一个参数存放鼠标的位置信息，类型为 COORD 坐标类型；</p>
<p>2.第二个参数（dwButtonState）为鼠标的按键状态，包含的值如下:</p>
<table>
<thead>
<tr>
<th align="left">鼠标按键状态码（dwButtonState）</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">FROM_LEFT_1ST_BUTTON_PRESSED</td>
<td align="left">最左边按键</td>
</tr>
<tr>
<td align="left">FROM_LEFT_2ND_BUTTON_PRESSED</td>
<td align="left">左起第二个按键</td>
</tr>
<tr>
<td align="left">FROM_LEFT_3RD_BUTTON_PRESSED</td>
<td align="left">左起第三个按键</td>
</tr>
<tr>
<td align="left">FROM_LEFT_4TH_BUTTON_PRESSED</td>
<td align="left">左起第四个按键</td>
</tr>
<tr>
<td align="left">RIGHTMOST_BUTTON_PRESSED</td>
<td align="left">最右边按键</td>
</tr>
</tbody></table>
<p>3.第三个参数是键盘控制键状态，这个和上一章的内容是一样的；</p>
<p>4.最后一个参数（dwEventFlag）为事件状态：</p>
<table>
<thead>
<tr>
<th align="left">事件状态码（dwEventFlag）</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">DOUBLE_CLICK</td>
<td align="left">双击</td>
</tr>
<tr>
<td align="left">MOUSE_MOVED</td>
<td align="left">移动</td>
</tr>
<tr>
<td align="left">MOUSE_WHEELED</td>
<td align="left">滚轮滚动（只适用于Windows 2000&#x2F;XP）</td>
</tr>
</tbody></table>
<p>在程序开头应加上</p>
<pre><code class="language-cpp">HANDLE hOut = GetStdHandle(STD_OUTPUT_HANDLE);
HANDLE hIn = GetStdHandle(STD_INPUT_HANDLE);
//这是用来添加鼠标输入设备的
</code></pre>
<p>用法举例</p>
<pre><code class="language-cpp">//我写的一个简单地例子
#include&lt;iostream&gt;
#include&lt;windows.h&gt;
using namespace std;
int main()
&#123;
	HANDLE hOut = GetStdHandle(STD_OUTPUT_HANDLE);
	HANDLE hIn = GetStdHandle(STD_INPUT_HANDLE);

	CONSOLE_SCREEN_BUFFER_INFO bInfo;
	INPUT_RECORD mouseRec;
	DWORD res;

	while(1)
	&#123;
		ReadConsoleInput(hIn, &amp;mouseRec, 1, &amp;res);//读取一个鼠标操作
		if(mouseRec.Event.MouseEvent.dwButtonState==FROM_LEFT_1ST_BUTTON_PRESSED)//如果点击了左键
		&#123;
			if (mouseRec.Event.MouseEvent.dwEventFlags == DOUBLE_CLICK)//如果是双击
			&#123;
				break;	//退出循环
			&#125;
			else//单击的情况
			&#123;
				cout&lt;&lt;mouseRec.Event.MouseEvent.dwMousePosition.X&lt;&lt;&quot; &quot;&lt;&lt;mouseRec.Event.MouseEvent.dwMousePosition.Y&lt;&lt;endl;//输出当前鼠标的位置
			&#125;
		&#125;
	&#125;
	CloseHandle(hOut);  // 关闭标准输出设备句柄  
	CloseHandle(hIn);   // 关闭标准输入设备句柄  
&#125;
</code></pre>
<p>摘自网络</p>
<pre><code class="language-cpp">#include &lt;windows.h&gt;  
#include &lt;stdio.h&gt;  
 
int main(void)  
&#123;  
	// 获取标准输入输出设备句柄  
	HANDLE hOut = GetStdHandle(STD_OUTPUT_HANDLE);        
	HANDLE hIn = GetStdHandle(STD_INPUT_HANDLE); 
	CONSOLE_SCREEN_BUFFER_INFO bInfo;
	INPUT_RECORD	mouseRec;
	DWORD			res;
	COORD			crPos, crHome = &#123;0, 0&#125;;
	printf(&quot;[Cursor Position] X: %2lu  Y: %2lu\n&quot;, 0, 0);	// 初始状态
	while (1)
	&#123;
		ReadConsoleInput(hIn, &amp;mouseRec, 1, &amp;res);
 
		if (mouseRec.EventType == MOUSE_EVENT)
		&#123;
			if (mouseRec.Event.MouseEvent.dwButtonState==FROM_LEFT_1ST_BUTTON_PRESSED)
			&#123;
				if (mouseRec.Event.MouseEvent.dwEventFlags == DOUBLE_CLICK)
				&#123;
					break;	// 左键双击 退出循环
				&#125;
			&#125;			
			crPos = mouseRec.Event.MouseEvent.dwMousePosition;
			GetConsoleScreenBufferInfo(hOut, &amp;bInfo);
			SetConsoleCursorPosition(hOut, crHome);
			printf(&quot;[Cursor Position] X: %2lu  Y: %2lu&quot;, crPos.X, crPos.Y);
			SetConsoleCursorPosition(hOut, bInfo.dwCursorPosition);
			switch (mouseRec.Event.MouseEvent.dwButtonState)
			&#123;
				case FROM_LEFT_1ST_BUTTON_PRESSED:			// 左键 输出A
					FillConsoleOutputCharacter(hOut, &#39;A&#39;, 1, crPos, &amp;res);
					break;		// 如果使用printf输出，则之前需要先设置光标的位置
 	
				case RIGHTMOST_BUTTON_PRESSED:				// 右键 输出a
					FillConsoleOutputCharacter(hOut, &#39;a&#39;, 1, crPos, &amp;res);
					break;
	 
				default:
					break;
			&#125;
		&#125;		
	&#125;
	CloseHandle(hOut);  // 关闭标准输出设备句柄  
	CloseHandle(hIn);   // 关闭标准输入设备句柄  
	return 0;  
&#125;
</code></pre>

    </div>
    <div id="twikoo"></div>
    <script>
        // Twikoo initialization
        twikoo.init({
            envId: 'http://101.200.30.183:8080/', // Replace with your Twikoo server URL
            el: '#twikoo'
        });
    </script>
	<script src="/js/contents.js"></script>
</div>
                </section>
				<footer class="footer">
	<div class="footer-content">
		<div class="footer-content-left">
			<p>博客观点仅代表作者，与第三方无关</p>
			<p>© 2018-2025 Mistyovo's Blog. All Rights Reserved.</p>
		</div>
		<div class="footer-content-right">
			<p><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/">闽ICP备2025101699号</a></p>
			<p>Powered by <a href="https://hexo.io" target="_blank">Hexo</a></p>
		</div>
	</div>
	<script>
		hljs.highlightAll();
		hljs.configure({
			tabReplace: '    '
		});
	</script>
</footer>
            </div>
		</div>
	</div>
	<div class="tools">
	<div class="tools-item reward">
		<i class="fa-brands fa-btc" onclick="reward()"></i>
	</div>
	<div class="tools-item sidebar-toggle" onclick="toggleSidebar()">
		<i class="fa-solid fa-bars"></i>
	</div>
	<div class="tools-item btt" onclick="scrollToTop()">
		<i class="fa-solid fa-turn-up"></i>
	</div>
</div>

<!-- 打赏悬浮窗遮罩层 -->
<div id="reward-overlay" class="reward-overlay" onclick="closeReward()"></div>

<!-- 打赏悬浮窗 -->
<div id="rewards" class="message-box">
	<div class="message-box-header">
		<h3 class="message-box-title">
			<i class="fa-solid fa-heart" style="color: #ff6b6b; margin-right: 8px;"></i>
			感谢支持
		</h3>
		<button class="message-box-close" onclick="closeReward()">
			<i class="fa-solid fa-xmark"></i>
		</button>
	</div>
	<div class="message-box-content">
		<img src="/images/wechat.png" alt="微信打赏码">
		<div class="reward-text">
			<p>如果您觉得这篇文章对您有帮助</p>
			<p>可以扫描上方二维码支持一下作者</p>
			<p style="margin-top: 10px; color: #ff6b6b;">
				<i class="fa-solid fa-heart"></i> 您的支持是我创作的动力 <i class="fa-solid fa-heart"></i>
			</p>
		</div>
	</div>
</div>

<script src="/js/tools.js"></script>
<script src="/js/navbar-scroll.js"></script>
<script src="/js/sidebar-toggle.js"></script>
</body>
</html>